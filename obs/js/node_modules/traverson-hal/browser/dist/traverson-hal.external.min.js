require=function a(i,d,s){function u(r,e){if(!d[r]){if(!i[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var o=d[r]={exports:{}};i[r][0].call(o.exports,function(e){return u(i[r][1][e]||e)},o,o.exports,a,i,d,s)}return d[r].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)u(s[e]);return u}({1:[function(e,r,t){var n=e("./lib/parser"),o=e("./lib/resource"),a=!1,i="undefined"!=typeof console&&"function"==typeof console.warn?console:{log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}};r.exports={parse:function(e){return new n(i).parse(e,a)},injectLogger:function(e){i=e},enableValidation:function(e){a=null==e||e},disableValidation:function(){a=!1},Resource:o}},{"./lib/parser":3,"./lib/resource":4}],2:[function(e,r,t){"use strict";function n(){1<=arguments.length?this._array=arguments[0]:this._array=[]}n.prototype.array=function(){return this._array},n.prototype.isEmpty=function(e){return 0===this._array.length},n.prototype.push=function(e){var r=this._array.slice(0);return r.push(e),new n(r)},n.prototype.pop=function(){return new n(this._array.slice(0,this._array.length-1))},n.prototype.peek=function(){if(this.isEmpty())throw new Error("can't peek on empty stack");return this._array[this._array.length-1]},r.exports=n},{}],3:[function(e,r,t){"use strict";var d,f=e("./resource"),n=e("./immutable_stack"),s={href:{required:!0,defaultValue:null},templated:{required:!1,defaultValue:!1},type:{required:!1,defaultValue:null},deprecation:{required:!1,defaultValue:null},name:{required:!1,defaultValue:null},profile:{required:!1,defaultValue:null},title:{required:!1,defaultValue:null},hreflang:{required:!1,defaultValue:null}};function o(e){d=e}function h(e,r,t){if(null==e)return e;var n,o,a,i,d,s,u,l=function(e,r,t){null!=(e=m(e,b,r,t))&&null!=e.self||v("Resource does not have a self link",r,t);return e}(e._links,r,t.push("_links")),c=(n=l)?n.curies:[],p=(o=e._embedded,a=r,i=t.push("_embedded"),null!=(d=m(o,k,a,i))&&Object.keys(d).forEach(function(t){d[t]=d[t].map(function(e){var r=h(e,null!=a?[]:null,i.push(t));return r._original=e,r})}),d),y=new f(l,c,p,r);return s=e,u=y,Object.keys(s).forEach(function(e){"_links"!==e&&"_embedded"!==e&&(u[e]=s[e])}),y._original=e,y}function m(d,s,u,l){if(null==d)return d;var c={};return Object.keys(d).forEach(function(e){var r,t,n,o,a,i;c[e]=(t=d[r=e],n=s,o=u,a=l,i=t,"[object Array]"===Object.prototype.toString.call(i)?t.map(function(e){return n(r,e,o,a)}):[n(r,t,o,a)])}),c}function b(r,e,t,n){if("object"!=typeof e)throw new Error("Link object is not an actual object: "+e+" ["+typeof e+"]");var o,a,i=(o=e,a={},Object.keys(o).forEach(function(e){a[e]=o[e]}),a);return Object.keys(s).forEach(function(e){null==i[e]&&(s[e].required&&v("Link misses required property "+e+".",t,n.push(r)),null!=s[e].defaultValue&&(i[e]=s[e].defaultValue))}),i.deprecation&&d.warn("Link "+u(n.push(r))+" is deprecated, see "+i.deprecation),!0!==i.templated&&!1!==i.templated&&(i.templated=!1),t&&i.href&&0<=i.href.indexOf("{")&&!i.templated&&v('Link seems to be an URI template but its "templated" property is not set to true.',t,n.push(r)),i}function k(e,r){return r}function v(e,r,t){r&&r.push({path:u(t),message:e})}function u(e){for(var r="$.",t=0;t<e.array().length;t++)r+=e.array()[t]+".";return r=r.substring(0,r.length-1)}o.prototype.parse=function(e,r){return h(e,r?[]:null,new n)},r.exports=o},{"./immutable_stack":2,"./resource":4}],4:[function(e,r,t){"use strict";function n(e,r,t,n){this._links=e||{},this._initCuries(r),this._embedded=t||{},this._validation=n||[]}function o(e,r){return null!=e?e[r]:null}function a(e,r,t){t=t||0;var n=o(e,r);return null!=n&&1<=n.length?n[t]:null}n.prototype._initCuries=function(e){if(this._curiesMap={},e){this._curies=e;for(var r=0;r<this._curies.length;r++){var t=this._curies[r];this._curiesMap[t.name]=t}}else this._curies=[];this._preResolveCuries()},n.prototype._preResolveCuries=function(){this._resolvedCuriesMap={};for(var e=0;e<this._curies.length;e++){var r=this._curies[e];if(r.name)for(var t in this._links)"curies"!==t&&this._preResolveCurie(r,t)}},n.prototype._preResolveCurie=function(e,r){this._links[r];var t=r.split(/:(.+)/),n=t[0];if(e.name===n)if(e.templated&&1<=t.length){var o=e.href.replace(/(.*){(.*)}(.*)/,"$1"+t[1]+"$3");this._resolvedCuriesMap[o]=r}else this._resolvedCuriesMap[e.href]=r},n.prototype.allLinkArrays=function(){return this._links},n.prototype.linkArray=function(e){return o(this._links,e)},n.prototype.link=function(e,r){return a(this._links,e,r)},n.prototype.hasCuries=function(e){return 0<this._curies.length},n.prototype.curieArray=function(e){return this._curies},n.prototype.curie=function(e){return this._curiesMap[e]},n.prototype.reverseResolveCurie=function(e){return this._resolvedCuriesMap[e]},n.prototype.allEmbeddedResourceArrays=function(){return this._embedded},n.prototype.embeddedResourceArray=function(e){return o(this._embedded,e)},n.prototype.embeddedResource=function(e,r){return a(this._embedded,e,r)},n.prototype.original=function(){return this._original},n.prototype.validationIssues=function(){return this._validation},n.prototype.allLinks=n.prototype.allLinkArrays,n.prototype.allEmbeddedArrays=n.prototype.allEmbeddedResources=n.prototype.allEmbeddedResourceArrays,n.prototype.embeddedArray=n.prototype.embeddedResourceArray,n.prototype.embedded=n.prototype.embeddedResource,n.prototype.validation=n.prototype.validationIssues,r.exports=n},{}],"traverson-hal":[function(e,r,t){"use strict";var i=e("halfred");function d(e){this.log=e,i.injectLogger(e)}function s(e,r,t){var n=new Error(e);return n.name=r,t&&(n.data=t),n}d.errors={InvalidArgumentError:"InvalidArgumentError",InvalidStateError:"InvalidStateError",LinkError:"HalLinkError",LinkMissingOrInvalidError:"HalLinkMissingOrInvalidError",EmbeddedDocumentsError:"HalEmbeddedDocumentsError"},d.mediaType="application/hal+json",d.prototype.findNextStep=function(e,r){if(null==r)throw s("Link object is null or undefined.",d.errors.InvalidArgumentError);if("object"!=typeof r)throw s("Links must be objects, not "+typeof r+": ",d.errors.InvalidArgumentError,r);if(!r.type)throw s("Link objects has no type attribute.",d.errors.InvalidArgumentError,r);switch(r.type){case"link-rel":return this._handleLinkRel(e,r);case"header":return this._handleHeader(e.lastStep.response,r);default:throw s("Link objects with type "+r.type+" are not supported by this adapter.",d.errors.InvalidArgumentError,r)}},d.prototype._handleLinkRel=function(e,r){var t=e.lastStep.doc,n=r.value;this.log.debug("parsing hal");var o,a={doc:t,halResource:i.parse(t),parsedKey:function(e){var r=e.match(/(.*)\[(.*):(.*)\]/);if(r)return{mode:"secondary",key:r[1],secondaryKey:r[2],secondaryValue:r[3],index:null};if(r=e.match(/(.*)\[(\d+)\]/))return{mode:"index",key:r[1],secondaryKey:null,secondaryValue:null,index:r[2]};if(r=e.match(/(.*)\[\$all\]/))return{mode:"all",key:r[1],secondaryKey:null,secondaryValue:null,index:null};return{mode:"first",key:e,secondaryKey:null,secondaryValue:null,index:null}}(n),linkStep:null,embeddedStep:null};return(o=a).halResource.hasCuries()&&(o.parsedKey.curie=o.halResource.reverseResolveCurie(o.parsedKey.key)),function(e,r){var t=e.halResource.linkArray(e.parsedKey.key);t||(t=e.halResource.linkArray(e.parsedKey.curie));if(!t||0===t.length)return;switch(e.parsedKey.mode){case"secondary":!function(e,r,t){for(var n=0;n<r.length;n++){var o=r[n][e.parsedKey.secondaryKey];if(null!=o&&o==e.parsedKey.secondaryValue)return r[n].href?(t.debug("found hal link: "+r[n].href),e.linkStep={url:r[n].href}):e.linkError="The link "+e.parsedKey.key+"["+e.parsedKey.secondaryKey+":"+e.parsedKey.secondaryValue+"] exists, but it has no href attribute."}e.linkError=e.parsedKey.key+"["+e.parsedKey.secondaryKey+":"+e.parsedKey.secondaryValue+"] requested, but there is no such link."}(e,t,r);break;case"index":!function(e,r,t){if(!r[e.parsedKey.index])return e.linkError="The link array "+e.parsedKey.key+" exists, but has no element at index "+e.parsedKey.index+".";if(!r[e.parsedKey.index].href)return e.linkError="The link "+e.parsedKey.key+"["+e.parsedKey.index+"] exists, but it has no href attribute.";t.debug("found hal link: "+r[e.parsedKey.index].href),e.linkStep={url:r[e.parsedKey.index].href}}(e,t,r);break;case"first":!function(e,r,t){for(var n,o=0;o<r.length;o++)if(r[o].href){n=r[o];break}n&&(1<r.length&&t.warn("Found HAL link array with more than one element for key "+e.parsedKey.key+", arbitrarily choosing index "+o+", because it was the first that had a href attribute."),t.debug("found hal link: "+n.href),e.linkStep={url:n.href})}(e,t,r);break;case"all":break;default:throw s("Illegal mode: "+e.parsedKey.mode,d.errors.InvalidArgumentError)}}(a,this.log),function(e,r){r.debug("checking for embedded: "+e.parsedKey.key+(e.parsedKey.index?e.parsedKey.index:""));var t=e.halResource.embeddedArray(e.parsedKey.key);if((!t||0===t.length)&&"all"!==e.parsedKey.mode)return;switch(r.debug("Found an array of embedded resource for: "+e.parsedKey.key),e.parsedKey.mode){case"secondary":!function(e,r,t){for(var n=0;n<r.length;n++){var o=r[n][e.parsedKey.secondaryKey];if(null!=o&&o==e.parsedKey.secondaryValue)return t.debug("Found an embedded resource for: "+e.parsedKey.key+"["+e.parsedKey.secondaryKey+":"+e.parsedKey.secondaryValue+"]"),e.embeddedStep={doc:r[n].original()}}e.embeddedError=e.parsedKey.key+"["+e.parsedKey.secondaryKey+":"+e.parsedKey.secondaryValue+"] requested, but the embedded array "+e.parsedKey.key+" has no such element."}(e,t,r);break;case"index":!function(e,r,t){if(!r[e.parsedKey.index])return e.embeddedError="The embedded array "+e.parsedKey.key+" exists, but has no element at index "+e.parsedKey.index+".";t.debug("Found an embedded resource for: "+e.parsedKey.key+"["+e.parsedKey.index+"]"),e.embeddedStep={doc:r[e.parsedKey.index].original()}}(e,t,r);break;case"all":!function(e,r,t){var n=e.halResource.original()._embedded&&e.halResource.original()._embedded[e.parsedKey.key];n?n instanceof Array||(n=[].concat(n)):n=[];e.embeddedStep={doc:n}}(e);break;case"first":!function(e,r,t){1<r.length&&t.warn("Found HAL embedded resource array with more than one element  for key "+e.parsedKey.key+", arbitrarily choosing first element.");e.embeddedStep={doc:r[0].original()}}(e,t,r);break;default:throw s("Illegal mode: "+e.parsedKey.mode,d.errors.InvalidArgumentError)}}(a,this.log),function(e,r,t){var n;n=t||"all"===e.parsedKey.mode?e.embeddedStep||e.linkStep:e.linkStep||e.embeddedStep;{if(n)return n;var o="Could not find a matching link nor an embedded document for "+r+".",a=d.errors.LinkError;throw e.linkError&&(o+=" Error while resolving linked documents: "+e.linkError,a=d.errors.LinkMissingOrInvalidError),e.embeddedError&&(o+=" Error while resolving embedded documents: "+e.embeddedError,e.linkError&&!t||(a=d.errors.EmbeddedDocumentsError)),s(o+=" Document: "+JSON.stringify(e.doc),a,e.doc)}}(a,n,e.preferEmbedded)},d.prototype._handleHeader=function(e,r){switch(r.value){case"location":var t=e.headers.location;if(!t)throw s("Following the location header but there was no location header in the last response.",d.errors.InvalidStateError);return{url:t};default:throw s("Link objects with type header and value "+r.value+" are not supported by this adapter.",d.errors.InvalidArgumentError,r)}},r.exports=d},{halfred:1}]},{},["traverson-hal"]);